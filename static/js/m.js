aspeed=300,isSafari=/constructor/i.test(window.HTMLElement)||"[object SafariRemoteNotification]"===(!window.safari||"undefined"!=typeof safari&&safari.pushNotification).toString(),img_cache=new Array,current_exp="",allowedChars="0123456789+=-*/",files={0:"/img/match0.webp",1:"/img/match1.webp",2:"/img/match2.webp",3:"/img/match3.webp",4:"/img/match4.webp",5:"/img/match5.webp",6:"/img/match6.webp",7:"/img/match7.webp",8:"/img/match8.webp",9:"/img/match9.webp","+":"/img/matchplus.webp","-":"/img/matchsub.webp","/":"/img/matchdiv.webp","*":"/img/matchmul.webp","=":"/img/matcheq.webp"};for(var i=0;i<allowedChars.length;i++)img_cache[i]=new Image,isSafari&&(files[allowedChars[i]]=files[allowedChars[i]].replace(".webp",".jp2")),img_cache[i].src=files[allowedChars[i]];function disable(){$("#easy").addClass("disabled"),$("#medium").addClass("disabled"),$("#hard").addClass("disabled"),$("#alert-box").slideUp()}function enable(){$("#easy").removeClass("disabled"),$("#medium").removeClass("disabled"),$("#hard").removeClass("disabled")}function getgame(e){$("#spin").show(),fetch("get",{body:"diff="+e.toString(),method:"post",headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(e=>e.text()).then(function(e){current_exp=e;for(var i=0;i<current_exp.length;i++)current_exp[i]in files&&$("#expr").append('<div class="el"><img src="'+files[current_exp[i]]+'" /></div>');$("#game").append('<input id="ans" type="text" placeholder="Answer" onkeydown="return checkChar(event);"><div id="send-btns"><button id="send">Send</button><button id="abandon">Abandon</button></div>'),$("#send").on("click",function(e){!0!==$("#ans").prop("disabled")&&($("#ans").prop("disabled",!0),$("#send").prop("disabled",!0),fetch("check",{body:"ans="+encodeURIComponent($("#ans").val())+"&eq="+encodeURIComponent(current_exp),method:"post",headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(e=>e.text()).then(function(e){1==e?(cleanGame(),$("#alert").removeClass("alert-danger").text("You solved it!").addClass("alert-success"),setTimeout(function(){$("#alert-box").slideDown()},10)):($("#alert").removeClass("alert-success").text("Try again!").addClass("alert-danger"),setTimeout(function(){$("#alert-box").slideDown()},10),$("#ans").val(""),$("#ans").prop("disabled",!1),$("#send").prop("disabled",!1))}))}),$("#abandon").on("click",function(e){cleanGame()}),$("#spin").hide(),$("#collapse").slideDown()})}function cleanGame(){$("#collapse").slideUp(),$("#begin").slideDown(),setTimeout(function(){$("#send-btns").remove(),$("#ans").remove(),$("#expr").empty(),current_exp="",enable()},500)}function checkChar(e){var i=e.key;return 13===e.keyCode&&!0==!$("#ans").prop("disabled")&&$("#send").trigger("click"),-1!==allowedChars.indexOf(i)||8===e.keyCode||37===e.keyCode||38===e.keyCode||39===e.keyCode||40===e.keyCode}$.fn.slideUp=function(){this.css("max-height",this.height().toString());let e=this;return setTimeout(function(){e.addClass("hidden")},2),this},$.fn.slideDown=function(){let e=4;this.children().each(function(i){e+=$(this).innerHeight()}),this.css("max-height",e.toString());let i=this;return setTimeout(function(){i.removeClass("hidden")},2),this},$("#easy").on("click",function(e){$("#easy").hasClass("disabled")||(disable(),$("#begin").slideUp(),getgame(1))}),$("#medium").on("click",function(e){$("#easy").hasClass("disabled")||(disable(),$("#begin").slideUp(),getgame(2))}),$("#hard").on("click",function(e){$("#hard").hasClass("disabled")||(disable(),$("#begin").slideUp(),getgame(3))}),$("document").ready(function(){"serviceWorker"in navigator&&window.addEventListener("load",function(){navigator.serviceWorker.register("/sw.js").then(function(e){console.log("ServiceWorker registration successful with scope: ",e.scope)},function(e){console.log("ServiceWorker registration failed: ",e)})})});